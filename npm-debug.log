0 info it worked if it ends with ok
1 verbose cli [ '/usr/bin/nodejs', '/usr/bin/npm', 'install', '-g', 'mupx' ]
2 info using npm@1.3.10
3 info using node@v0.10.25
4 verbose cache add [ 'mupx', null ]
5 verbose cache add name=undefined spec="mupx" args=["mupx",null]
6 verbose parsed url { protocol: null,
6 verbose parsed url   slashes: null,
6 verbose parsed url   auth: null,
6 verbose parsed url   host: null,
6 verbose parsed url   port: null,
6 verbose parsed url   hostname: null,
6 verbose parsed url   hash: null,
6 verbose parsed url   search: null,
6 verbose parsed url   query: null,
6 verbose parsed url   pathname: 'mupx',
6 verbose parsed url   path: 'mupx',
6 verbose parsed url   href: 'mupx' }
7 silly lockFile 0b3dc23b-mupx mupx
8 verbose lock mupx /home/bob/.npm/0b3dc23b-mupx.lock
9 silly lockFile 0b3dc23b-mupx mupx
10 silly lockFile 0b3dc23b-mupx mupx
11 verbose addNamed [ 'mupx', '' ]
12 verbose addNamed [ null, '*' ]
13 silly lockFile 3f441f8b-mupx mupx@
14 verbose lock mupx@ /home/bob/.npm/3f441f8b-mupx.lock
15 silly addNameRange { name: 'mupx', range: '*', hasData: false }
16 verbose url raw mupx
17 verbose url resolving [ 'https://registry.npmjs.org/', './mupx' ]
18 verbose url resolved https://registry.npmjs.org/mupx
19 info trying registry request attempt 1 at 11:04:59
20 verbose etag "4Y3WY54Z2026OVL7FLLN91YHW"
21 http GET https://registry.npmjs.org/mupx
22 http 304 https://registry.npmjs.org/mupx
23 silly registry.get cb [ 304,
23 silly registry.get   { date: 'Wed, 06 Apr 2016 15:04:59 GMT',
23 silly registry.get     via: '1.1 varnish',
23 silly registry.get     'cache-control': 'max-age=300',
23 silly registry.get     etag: '"4Y3WY54Z2026OVL7FLLN91YHW"',
23 silly registry.get     age: '0',
23 silly registry.get     connection: 'keep-alive',
23 silly registry.get     'x-served-by': 'cache-iad2133-IAD',
23 silly registry.get     'x-cache': 'MISS',
23 silly registry.get     'x-cache-hits': '0',
23 silly registry.get     'x-timer': 'S1459955099.627348,VS0,VE69',
23 silly registry.get     vary: 'Accept-Encoding' } ]
24 verbose etag mupx from cache
25 silly addNameRange number 2 { name: 'mupx', range: '*', hasData: true }
26 silly addNameRange versions [ 'mupx',
26 silly addNameRange   [ '1.0.0',
26 silly addNameRange     '1.0.1',
26 silly addNameRange     '1.0.2',
26 silly addNameRange     '1.1.0',
26 silly addNameRange     '1.1.1',
26 silly addNameRange     '1.1.2',
26 silly addNameRange     '1.1.3',
26 silly addNameRange     '1.2.0',
26 silly addNameRange     '1.3.0',
26 silly addNameRange     '1.4.0',
26 silly addNameRange     '1.4.1',
26 silly addNameRange     '1.5.0',
26 silly addNameRange     '1.5.1',
26 silly addNameRange     '1.5.2',
26 silly addNameRange     '1.5.3' ] ]
27 verbose addNamed [ 'mupx', '1.5.3' ]
28 verbose addNamed [ '1.5.3', '1.5.3' ]
29 silly lockFile db924502-mupx-1-5-3 mupx@1.5.3
30 verbose lock mupx@1.5.3 /home/bob/.npm/db924502-mupx-1-5-3.lock
31 silly lockFile db924502-mupx-1-5-3 mupx@1.5.3
32 silly lockFile db924502-mupx-1-5-3 mupx@1.5.3
33 silly lockFile 3f441f8b-mupx mupx@
34 silly lockFile 3f441f8b-mupx mupx@
35 silly resolved [ { name: 'mupx',
35 silly resolved     version: '1.5.3',
35 silly resolved     description: 'Production Quality Meteor Deployments',
35 silly resolved     dependencies:
35 silly resolved      { async: '^0.9.0',
35 silly resolved        cjson: '0.3.x',
35 silly resolved        colors: '0.6.x',
35 silly resolved        nodemiral: '^1.1.1',
35 silly resolved        rimraf: '2.x.x',
35 silly resolved        underscore: '1.7.0',
35 silly resolved        uuid: '1.4.x',
35 silly resolved        archiver: '0.14.x',
35 silly resolved        'update-notifier': '0.4.x',
35 silly resolved        minimist: '1.1.1' },
35 silly resolved     bin: { mupx: './bin/mup' },
35 silly resolved     author:
35 silly resolved      { name: 'Arunoda Susiripala',
35 silly resolved        email: 'arunoda.susiripala@gmail.com' },
35 silly resolved     repository: { type: 'git', url: 'git://github.com/arunoda/meteor-up.git' },
35 silly resolved     license: 'MIT',
35 silly resolved     readme: '# Meteor Up X (Development Version)\n\n> This is the latest development version of Meteor Up and known as `mupx`. Once `mupx` becomes stable we\'ll merge into master and release as `mup`.\n\n#### Production Quality Meteor Deployments\n\nMeteor Up is a command line tool that allows you to deploy any [Meteor](http://meteor.com) app to your own server. It currently supports Ubuntu. There are plans to support other linux distros soon.\n\nYou can use install and use Meteor Up from Linux, Mac and **Windows**.\n\nThis version of Meteor Up is powered by [Docker](http://www.docker.com/) and it makes Meteor Up easy to manage. It also reduce a lot of server specific errors.\n\n**Table of Contents**\n\n- [Features](#features)\n- [Server Configuration](#server-configuration)\n- [Installation](#installation)\n- [Creating a Meteor Up Project](#creating-a-meteor-up-project)\n- [Example File](#example-file)\n- [Setting Up a Server](#setting-up-a-server)\n- [Deploying an App](#deploying-an-app)\n- [Build Options](#build-options)\n- [Additional Setup/Deploy Information](#additional-setupdeploy-information)\n    - [Server Setup Details](#server-setup-details)\n    - [Deploy Wait Time](#deploy-wait-time)\n    - [Multiple Deployment Targets](#multiple-deployment-targets)\n- [Accessing the Database](#accessing-the-database)\n- [Multiple Deployments](#multiple-deployments)\n- [Server Specific Environment Variables](#server-specific-environment-variables)\n- [SSL Support](#ssl-support)\n- [Updating](#updating)\n- [Troubleshooting](#troubleshooting)\n- [Migrating from Meteor Up 0.x](#migrating-from-meteor-up-0x)\n\n### Features\n\n* Single command server setup\n* Single command deployment\n* Multi server deployment\n* Environmental Variables management\n* Support for [`settings.json`](http://docs.meteor.com/#meteor_settings)\n* Password or Private Key(pem) based server authentication\n* Access, logs from the terminal (supports log tailing)\n* Support for multiple meteor deployments (experimental)\n\n### Server Configuration\n\n* Auto-Restart if the app crashed\n* Auto-Start after the server reboot\n* Runs with docker so gives us better security and isolation.\n* Revert to the previous version, if the deployment failed\n* Secured MongoDB Installation (Optional)\n* Pre-Installed PhantomJS\n\n### Installation\n\n    npm install -g mupx\n\n### Creating a Meteor Up Project\n\n    mkdir ~/my-meteor-deployment\n    cd ~/my-meteor-deployment\n    mupx init\n\nThis will create two files in your Meteor Up project directory:\n\n  * mup.json - Meteor Up configuration file\n  * settings.json - Settings for Meteor\'s [settings API](http://docs.meteor.com/#meteor_settings)\n\n`mup.json` is commented and easy to follow (it supports JavaScript comments).\n\n### Example File\n\n```js\n{\n  // Server authentication info\n  "servers": [\n    {\n      "host": "hostname",\n      "username": "root",\n      "password": "password",\n      // or pem file (ssh based authentication)\n      // WARNING: Keys protected by a passphrase are not supported\n      //"pem": "~/.ssh/id_rsa"\n      // Also, for non-standard ssh port use this\n      //"sshOptions": { "port" : 49154 },\n      // server specific environment variables\n      "env": {}\n    }\n  ],\n\n  // Install MongoDB on the server. Does not destroy the local MongoDB on future setups\n  "setupMongo": true,\n\n  // Application name (no spaces).\n  "appName": "meteor",\n\n  // Location of app (local directory). This can reference \'~\' as the users home directory.\n  // i.e., "app": "~/Meteor/my-app",\n  // This is the same as the line below.\n  "app": "/Users/arunoda/Meteor/my-app",\n\n  // Configure environment\n  // ROOT_URL must be set to your correct domain (https or http)\n  "env": {\n    "PORT": 80,\n    "ROOT_URL": "http://myapp.com"\n  },\n\n  // Meteor Up checks if the app comes online just after the deployment.\n  // Before mup checks that, it will wait for the number of seconds configured below.\n  "deployCheckWaitTime": 15,\n\n  // show a progress bar while uploading.\n  // Make it false when you deploy using a CI box.\n  "enableUploadProgressBar": true\n}\n```\n\n### Setting Up a Server\n\n    mupx setup\n\nThis will setup the server for the `mupx` deployments. It will take around 2-5 minutes depending on the server\'s performance and network availability.\n\n### Deploying an App\n\n    mupx deploy\n\nThis will bundle the Meteor project and deploy it to the server. Bundling process is very similar to how `meteor deploy` do it.\n\n### Other Utility Commands\n\n* `mupx reconfig` - reconfigure app with new environment variables and Meteor settings\n* `mupx stop` - stop the app\n* `mupx start` - start the app\n* `mupx restart` - restart the app\n* `mupx logs [-f --tail=50]` - get logs\n\n### Build Options\n\nWhen building the meteor app, we can invoke few options. So, you can mention them in `mup.json` like this:\n\n~~~js\n...\n"buildOptions": {\n  // build with the debug mode on\n  "debug": true,\n  // mobile setting for cordova apps\n  "mobileSettings": {\n    "public": {\n      "meteor-up": "rocks"\n    }\n  },\n  // executable used to build the meteor project\n  // you can set a local repo path if needed\n  "executable": "meteor"\n}\n...\n~~~\n\n### Additional Setup/Deploy Information\n\n#### Deploy Wait Time\n\nMeteor Up checks if the deployment is successful or not just after the deployment. By default, it will wait 15 seconds before the check. You can configure the wait time with the `deployCheckWaitTime` option in the `mup.json`\n\n#### SSH keys with paraphrase (or ssh-agent support)\n\n> This only tested with Mac/Linux\n\nIt\'s common to use paraphrase enabled SSH keys to add an extra layer of protection to your SSH keys. You can use those keys with `mup` too. In order to do that, you need to use a `ssh-agent`.\n\nHere\'s the process:\n\n* First remove your `pem` field from the `mup.json`. So, your `mup.json` only has the username and host only.\n* Then start a ssh agent with `eval $(ssh-agent)`\n* Then add your ssh key with `ssh-add <path-to-key>`\n* Then you\'ll asked to enter the paraphrase to the key\n* After that simply invoke `mup` commands and they\'ll just work\n* Once you\'ve deployed your app kill the ssh agent with `ssh-agent -k`\n\n#### Ssh based authentication with `sudo`\n\n**If your username is `root` or using AWS EC2, you don\'t need to follow these steps**\n\nPlease ensure your key file (pem) is not protected by a passphrase. Also the setup process will require NOPASSWD access to sudo. (Since Meteor needs port 80, sudo access is required.)\n\nMake sure you also add your ssh key to the ```/YOUR_USERNAME/.ssh/authorized_keys``` list\n\nYou can add your user to the sudo group:\n\n    sudo adduser *username*  sudo\n\nAnd you also need to add NOPASSWD to the sudoers file:\n\n    sudo visudo\n\n    # replace this line\n    %sudo  ALL=(ALL) ALL\n\n    # by this line\n    %sudo ALL=(ALL) NOPASSWD:ALL  \n\nWhen this process is not working you might encounter the following error:\n\n    \'sudo: no tty present and no askpass program specified\'\n\n#### Server Setup Details\n\nMeteor Up uses Docker to run and manage your app. It uses [MeteorD](https://github.com/meteorhacks/meteord) behind the scenes. Here\'s how we manage and utilize the server.\n\n* your currently running meteor bundle lives at `/opt/<appName>/current`.\n* we\'ve a demonized docker container running the above bundle.\n* docker container is started with `--restart=always` flag and it\'ll re-spawn the container if dies.\n* logs are maintained via Docker.\n* If you decided to use MongoDB, it\'ll be also running as a Docker conatiner. It\'s bound to the local interface and port 27017 (you cannot access from the outside)\n* the database is named `<appName>`\n\nFor more information see [`lib/taskLists.js`](https://github.com/arunoda/meteor-up/blob/mupx/lib/taskLists/linux.js).\n\n#### Multiple Deployment Targets\n\nYou can use an array to deploy to multiple servers at once.\n\nTo deploy to *different* environments (e.g. staging, production, etc.), use separate Meteor Up configurations in separate directories, with each directory containing separate `mup.json` and `settings.json` files, and the `mup.json` files\' `app` field pointing back to your app\'s local directory.\n\n### Accessing the Database\n\nYou can\'t access the MongoDB from the outside the server. To access the MongoDB shell you need to log into your server via SSH first and then run the following command:\n\n    docker exec -it mongodb mongo <appName>\n\n> Later on we\'ll be using a separate MongoDB instance for every app.\n\n### Server Specific Environment Variables\n\nIt is possible to provide server specific environment variables. Add the `env` object along with the server details in the `mup.json`. Here\'s an example:\n\n~~~js\n{\n  "servers": [\n    {\n      "host": "hostname",\n      "username": "root",\n      "password": "password"\n      "env": {\n        "SOME_ENV": "the-value"\n      }\n    }\n\n  ...\n}\n~~~\n\nBy default, Meteor Up adds `CLUSTER_ENDPOINT_URL` to make [cluster](https://github.com/meteorhacks/cluster) deployment simple. But you can override it by defining it yourself.\n\n### Multiple Deployments\n\nMeteor Up supports multiple deployments to a single server. Meteor Up only does the deployment; if you need to configure subdomains, you need to manually setup a reverse proxy yourself.\n\nLet\'s assume, we need to deploy production and staging versions of the app to the same server. The production app runs on port 80 and the staging app runs on port 8000.\n\nWe need to have two separate Meteor Up projects. For that, create two directories and initialize Meteor Up and add the necessary configurations.\n\nIn the staging `mup.json`, add a field called `appName` with the value `staging`. You can add any name you prefer instead of `staging`. Since we are running our staging app on port 8000, add an environment variable called `PORT` with the value 8000.\n\nNow setup both projects and deploy as you need.\n\n### Changing `appName`\n\nIt\'s pretty okay to change the `appName`. But before you do so, you need to stop the project with older `appName`\n\n### Custom configuration and settings files\n\nYou can keep multiple configuration and settings files in the same directory and pass them to mup using the command parameters `--settings` and `--config`. For example, to use a file `mup-staging.json` and `staging-settings.json` add the parameters like this:\n\n    mup deploy --config=mup-staging.json --settings=staging-settings.json\n\n### SSL Support\n\nMeteor Up can enable SSL support for your app. It\'s uses the latest version of Nginx for that.\n\nTo do that just add following configuration to your `mup.json` file.\n\n~~~js\n{\n  ...\n\n  "ssl": {\n    "certificate": "./bundle.crt", // this is a bundle of certificates\n    "key": "./private.key", // this is the private key of the certificate\n    "port": 443 // 443 is the default value and it\'s the standard HTTPS port\n  }\n\n  ...\n}\n~~~\n\nNow, simply do `mup setup` and then `mup deploy`. Now your app is running with a modern SSL setup.\n\nTo learn more about the SSL setup refer to the [`mup-frontend-server`](https://github.com/meteorhacks/mup-frontend-server) project.\n\n### Updating Mup\n\nTo update `mupx` to the latest version, just type:\n\n    npm update mupx -g\n\nYou should try and keep `mupx` up to date in order to keep up with the latest Meteor changes.\n\n### Troubleshooting\n\n#### Check Logs\nIf you suddenly can\'t deploy your app anymore, first use the `mupx logs -f` command to check the logs for error messages.\n\nOne of the most common problems is your Node version getting out of date. In that case, see “Updating” section above.\n\n#### Verbose Output\nIf you need to see the output of `mupx` (to see more precisely where it\'s failing or hanging, for example), run it like so:\n\n    DEBUG=* mupx <command>\n\nwhere `<command>` is one of the `mupx` commands such as `setup`, `deploy`, etc.\n\n### Migrating from Meteor Up 0.x\n\n`mupx` is not fully backward compatible with Meteor Up 0.x. But most of the `mup.json` remain the same. Here are some of the changes:\n\n* Docker is the now runtime for Meteor Up\n* We don\'t have use Upstart any more\n* You don\'t need to setup NodeJS version or PhantomJS manually (MeteorD will take care of it)\n* We use a mongodb docker container to run the local mongodb data (it uses the old mongodb location)\n* It uses a Nginx and a different SSL configurations\n* Now we don\'t re-build binaries. Instead we build for the `os.linux.x86_64` architecture. (This is the same thing what meteor-deploy does)\n\n#### Migration Guide\n\n> Use a new server if possible as you can. Then migrate DNS accordingly. That\'s the easiest and safest way.\n\nLet\'s assume our appName is `meteor`\n\n* stop the app with `stop meteor`\n* Then remove upstrat config file: `rm /etc/init/meteor.conf`\n* stop stud if you are using SSL: `stop stud`\n* Then remove upstrat config file: `rm /etc/init/stud.conf`\n* Stop mongodb if you are using: `stop mongod`\n* Remove MongoDB with: `apt-get remove mongodb`\n\nThen do `mupx setup` and then `mupx deploy`.\n',
35 silly resolved     readmeFilename: 'README.md',
35 silly resolved     bugs: { url: 'https://github.com/arunoda/meteor-up/issues' },
35 silly resolved     _id: 'mupx@1.5.3',
35 silly resolved     _from: 'mupx@' } ]
36 info install mupx@1.5.3 into /usr/local/lib
37 info installOne mupx@1.5.3
38 info /usr/local/lib/node_modules/mupx unbuild
39 info preuninstall mupx@1.5.3
40 info uninstall mupx@1.5.3
41 verbose true,/usr/local/lib/node_modules,/usr/local/lib/node_modules unbuild mupx@1.5.3
42 verbose /usr/local/bin,[object Object] binRoot
43 info /usr/local/lib/node_modules/mupx unbuild
44 info preuninstall mupx@1.5.3
45 info uninstall mupx@1.5.3
46 verbose true,/usr/local/lib/node_modules,/usr/local/lib/node_modules unbuild mupx@1.5.3
47 verbose /usr/local/bin,[object Object] binRoot
48 error error rolling back Error: EACCES, unlink '/usr/local/bin/mupx'
48 error error rolling back  mupx@1.5.3 { [Error: EACCES, unlink '/usr/local/bin/mupx'] errno: 3, code: 'EACCES', path: '/usr/local/bin/mupx' }
49 error Error: EACCES, unlink '/usr/local/bin/mupx'
49 error  { [Error: EACCES, unlink '/usr/local/bin/mupx'] errno: 3, code: 'EACCES', path: '/usr/local/bin/mupx' }
50 error Please try running this command again as root/Administrator.
51 error System Linux 3.13.0-24-generic
52 error command "/usr/bin/nodejs" "/usr/bin/npm" "install" "-g" "mupx"
53 error cwd /home/bob/Icelist
54 error node -v v0.10.25
55 error npm -v 1.3.10
56 error path /usr/local/bin/mupx
57 error code EACCES
58 error errno 3
59 error stack Error: EACCES, unlink '/usr/local/bin/mupx'
60 verbose exit [ 3, true ]
